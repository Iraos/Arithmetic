<head>
  <title>Arithmetic</title>
</head>

<body>
  <div class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">Arithmetic</a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
          <a href="/quiz">New Quiz</a>
        </li>
        <li>
          <a href="/pastresults">Past Results</a>
        </li>
        {{#if isInRole 'teacher'}}
        <li>
          <a href="/admin">Teacher Area</a>
        </li>
        {{/if}}
      </ul>
      <ul class="nav navbar-nav navbar-right">
        {{> loginButtons}}
      </ul>
    </div>
  </div>
</body>
<template name="main-menu">
  <div class="row col-md-6 col-md-offset-3 centered">
    <a href="/quiz">
      <div class="row menu-button">
        <button class="btn btn-success col-md-4 col-md-offset-4 centered" id="newquiz">Begin New Quiz</button>
      </div>
    </a>
    <a href="/pastresults">
      <div class="row menu-button">
        <button class="btn btn-warning col-md-4 col-md-offset-4 centered" id="pastresults">View Past Results</button>
      </div>
    </a>
    {{#if isInRole 'teacher'}}
    <a href="/admin">
      <div class="row menu-button">
        <button class="btn btn-danger col-md-4 col-md-offset-4 centered" id="teacherarea">Teacher Area</button>
      </div>
    </a>
    {{/if}}
  </div>
</template>

<template name="quiz">
  <div class="row col-md-6 col-md-offset-3 centered">
    <h2><small>Question #{{questionNum}}</small></h2>
    <hr />
    <h1>{{question}}</h1>
    <form id='answer'>
      <input type="text" name="answer">
      <input type="submit" value="Submit">
    </form>
  </div>
  <style>
    .grn {
      background-color: #7FE368;
      opacity: 20%;
      -webkit-transition: background 10ms linear;
      -moz-transition: background 10ms linear;
      -o-transition: background 10ms linear;
      transition: background 10ms linear;
    }

    .red {
      background-color: #C50D22;
      opacity: 20%;
      -webkit-transition: background 10ms linear;
      -moz-transition: background 10ms linear;
      -o-transition: background 10ms linear;
      transition: background 10ms linear;
    }

    .fadeout {
      background-color: none;
      -webkit-transition: background 1s ease-out;
      -moz-transition: background 1s ease-out;
      -o-transition: background 1s ease-out;
      transition: background 1s ease-out;
    }
  </style>
</template>

<template name="results">
  <div class="col-md-2 col-md-offset-5">
    <h2>Results</h2> {{> reactiveTable settings=settings class="table table-bordered table-hover"}}
  </div>
</template>

<template name="login">
  <div id="login-box">{{> loginButtons}}</div>
  <style>
    #login-box li.dropdown {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }

    #login-box li.dropdown .dropdown-menu {
      float: none;
      position: relative;
      background-color: #ffffff;
    }

    #login-box li.dropdown .dropdown-menu .alert-danger {
      color: #a94442;
    }

    #login-box li.dropdown .dropdown-menu:after {
      visibility: hidden;
      display: block;
      font-size: 0;
      content: " ";
      clear: both;
      height: 0;
    }
  </style>
</template>

<template name='admin'>
  <div class="row col-md-6 col-md-offset-3 centered">
    <form id="new-user-form" action="action">
      <div>
        <p>
          <h3>Add new user</h3>
        </p>
        <input type="username" id="account-username" />
        <input type="password" id="account-password" />
        <select id='account-role'>
          <option value="teacher">Teacher</option>
          <option value="student">Student</option>
          <option value="Class 1">Class 1</option>
          <option value="Class 2">Class 2</option>
          <option value="Class 3">Class 3</option>
        </select>
        <input type="submit" id="create-account" value="Create account" />
        <p>
          {{newUserFeedback}}
        </p>
      </div>
    </form>
    <form id="move-user-form" action="action">
      <div>
        <p>
          <h3>Change user role</h3>
        </p>
        <input type="username" id="move-username" />
        <select id='move-role'>
          <option value="teacher">Teacher</option>
          <option value="student">Student</option>
          <option value="Class 1">Class 1</option>
          <option value="Class 2">Class 2</option>
          <option value="Class 3">Class 3</option>
        </select>
        <input type="submit" id="add-user-to-group" value="Submit" />
        <p>
          {{moveToGroupFeedback}}
        </p>
      </div>
    </form>
    <script>
      $('#myTabs a').click(function(e) {
        e.preventDefault()
        $(this).tab('show')
      })
    </script>
    <style>
      #users li {
        list-style-type: none;
      }

      #users div {
        padding: 0, 0, 0, 0;
        margin: 0, 0, 0, 0;
      }
    </style>
    <div>
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#users" aria-controls="users" role="tab" data-toggle="tab">Users</a></li>
        <li role="presentation"><a href="#results" aria-controls="results" role="tab" data-toggle="tab">Results</a></li>
        <li role="presentation"><a href="#groups" aria-controls="groups" role="tab" data-toggle="tab">Groups</a></li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="users">
          <div class="row">
            <div class="col-md-4 list-group">
              <ul class="user-list sortable1 .col-md-4">
                <li class="list-group-item disabled">Class 1</li>
                {{#each class1Users}}
                <li class="userlist-item list-group-item">{{> userDrag username=username}}</li>
                {{/each}}
              </ul>
            </div>
            <div class="col-md-4 list-group">
              <ul class="user-list sortable2 .col-md-4">
                <li class="list-group-item disabled">Class 2</li>
                {{#each class2Users}}
                <li class="userlist-item list-group-item">{{> userDrag username=username}}</li>
                {{/each}}
              </ul>
            </div>
            <div class="col-md-4 list-group">
              <ul class="user-list sortable3 .col-md-4">
                <li class="list-group-item disabled">Class 3</li>
                {{#each class3Users}}
                <li class="userlist-item list-group-item">{{> userDrag username=username}}</li>
                {{/each}}
              </ul>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="results">
          <div class="row">
            <div class="col-sm-4">
              <div class="input-group">
                <input type="text" class="form-control" id="filterText" placeholder="Filter">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-default" id="filterTextClear"><span class="glyphicon glyphicon-remove-circle"></span></button>
                </span>
              </div>
            </div>
            <div class="pull-left col-sm-8">
              <div class="btn-group" role="group">
                <button type="button" class="btn btn-default disabled">Show:</button>
                <button type="button" id="showClass1" class="btn btn-default {{showClass1state}}">Class 1</button>
                <button type="button" id="showClass2" class="btn btn-default {{showClass2state}}">Class 2</button>
                <button type="button" id="showClass3" class="btn btn-default {{showClass3state}}">Class 3</button>
                <div class="btn-group" role="group">
                  <button type="button" class="btn btn-default disabled">{{{sortByLabel}}}</button>
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu">
                    <li><a href='#' id="sortAvScoreAsc">Average Score <span class="glyphicon glyphicon-chevron-up"></span></a></li>
                    <li><a href='#' id="sortAvScoreDec">Average Score <span class="glyphicon glyphicon-chevron-down"></span></a></li>
                    <li><a href='#' id="sortNameAsc">Name <span class="glyphicon glyphicon-chevron-up"></span></a></li>
                    <li><a href='#' id="sortNameDec">Name <span class="glyphicon glyphicon-chevron-down"></span></a></li>
                  </ul>
                </div>
              </div>
            </div>
            <hr /> {{#if results}} {{#each item in results}}
            <div class='panel panel-default'>
              <div class='panel-heading accordion-toggle collapsed' data-toggle="collapse" data-target="#collapse{{@index}}">
                <div class="row">
                  <h4 class='panel-title col-sm-2' id='datetime'>{{item.username}}</h4>
                  <h4 class='panel-title col-sm-2' id='datetime'>{{item.class}}</h4>
                  <h4 class='panel-title col-sm-4' id="datetime">{{dateconv item.date}}</h4>
                  <h4 class='panel-title col-sm-2 pull-right' id="score">{{item.correct}}/10</h4>
                </div>
              </div>
              <div id='collapse{{@index}}' class='panel-collapse collapse'>
                <div class='panel-body'>
                  <!-- {{> reactiveTable collection=item.data settings=(settings item.correct) class="table table-bordered table-hover"}} -->
                </div>
              </div>
            </div>
            {{/each}}
            {{else}}
            <h3>No results found</h3> {{/if}}
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="groups">2</div>
      </div>
    </div>
  </div>
  <style>
    .panel-heading.accordion-toggle:after {
      /* symbol for "opening" panels */
      font-family: 'Glyphicons Halflings';
      /* essential for enabling glyphicon */
      content: "\e114";
      /* adjust as needed, taken from bootstrap.css */
      float: right;
      position: relative;
      bottom: 23px;
      font-size: 15pt;
      /* adjust as needed */
      color: grey;
      /* adjust as needed */
    }

    .panel-heading.accordion-toggle.collapsed:after {
      /* symbol for "collapsed" panels */
      content: "\e080";
      /* adjust as needed, taken from bootstrap.css */
    }

    #datetime {
      text-align: left;
      float: left;
    }

    #score {
      text-align: center;
    }
  </style>
</template>

<template name="userDrag">
  {{username}}
</template>

<template name='debug'>
  <div class="col-md-2 col-md-offset-5">
    <h2>Data Generator</h2>
    <form id='generatedata'>
      <input type="username" id="generatedata-user" />
      <select id='generatedata-score'>
        <option value=""></option>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
      </select>
      <input type="submit" id="generatedata-submit" value="Generate" />
    </form>
    <hr />
    <h2>User List & Groups</h2>
  </div>
</template>

<template name='pastresults'>
  <div class="row col-md-6 col-md-offset-3 centered">
    <div class='panel group'>
      {{#if dates}}
      <h3>Progress</h3>
      <div id="progChart" style="height:20vh">
        {{> highchartsHelper chartId="progChart" chartObject=progChart}}
      </div>
      <hr style="margin-top: 0" />
      <h3>Results</h3> {{#each item in dates}}
      <div class='panel panel-default'>
        <div class='panel-heading accordion-toggle collapsed' data-toggle="collapse" data-target="#collapse{{@index}}">
          <h4 class='panel-title' id="datetime">
              {{dateconv item.date}}</h4>
          <h4 class='panel-title' id="score">{{item.correct}}/10</h4>
        </div>
        <div id='collapse{{@index}}' class='panel-collapse collapse'>
          <div class='panel-body'>
            {{> reactiveTable collection=item.data settings=(settings item.correct) class="table table-bordered table-hover"}}
          </div>
        </div>
      </div>
      {{/each}} {{else}}
      <h3>You have no results yet.</h3> {{/if}}
    </div>
  </div>
  <style>
    .panel-heading.accordion-toggle:after {
      /* symbol for "opening" panels */
      font-family: 'Glyphicons Halflings';
      /* essential for enabling glyphicon */
      content: "\e114";
      /* adjust as needed, taken from bootstrap.css */
      float: right;
      position: relative;
      bottom: 23px;
      font-size: 15pt;
      /* adjust as needed */
      color: grey;
      /* adjust as needed */
    }

    .panel-heading.accordion-toggle.collapsed:after {
      /* symbol for "collapsed" panels */
      content: "\e080";
      /* adjust as needed, taken from bootstrap.css */
    }

    #datetime {
      text-align: left;
      float: left;
    }

    #score {
      text-align: center;
    }
  </style>

</template>
